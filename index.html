<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horaires des Bus</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
            background-color: black;
            color: #00ff00;
        }
        .led-screen {
            width: 80%;
            margin: auto;
            padding: 20px;
            border: 3px solid #00ff00;
            font-size: 1.5em;
            background-color: black;
            color: #00ff00;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 150px;
        }
        table {
            width: 60%;
            margin: auto;
            border-collapse: collapse;
            background-color: black;
            color: #00ff00;
        }
        th, td {
            border: 1px solid #00ff00;
            padding: 10px;
        }
        th {
            background-color: #00ff00;
            color: black;
        }
    </style>
</head>
<body>
    <div class="led-screen" id="led-screen">Chargement...</div>
    
    <table>
        <thead>
            <tr>
                <th>Ligne</th>
                <th>Destination</th>
                <th>Temps restant</th>
                <th>Quai</th>
            </tr>
        </thead>
        <tbody id="horaires">
            <tr><td colspan="4">Chargement des horaires...</td></tr>
        </tbody>
    </table>
    
    <script>
    function updateLedScreen() {
        const now = new Date();
        const dateStr = now.toLocaleDateString('fr-FR');
        const timeStr = now.toLocaleTimeString('fr-FR');
        document.getElementById("led-screen").innerHTML = `Beauregard | ${dateStr} - ${timeStr}`;
    }

    function getNextPassages() {
        const horairesDiv = document.getElementById("horaires");
        const now = new Date();
        const currentMinutesOfDay = now.getHours() * 60 + now.getMinutes();
        const isWeekend = now.getDay() === 0 || now.getDay() === 6;

        const horairesBus = {
            "L30": { destination: "Gare Centrale", quai: "Lycée", horaires: isWeekend ? [570, 660, 810, 945, 1080] : [480, 555, 630, 720, 885, 980, 1080, 1170, 1260] },
            "L31": { destination: "Université", quai: "Gendarmerie", horaires: isWeekend ? [600, 750, 840, 990, 1140] : [465, 540, 675, 780, 930, 1065, 1215] },
            "L32": { destination: "Hôpital", quai : "Gendarmerie", horaires: isWeekend ? [525, 615, 765, 900, 1050] : [390, 495, 600, 750, 855, 1005, 1140, 1290] },
            "L11": { destination: "Stade", quai:"Lycée", horaires: isWeekend ? [555, 705, 855, 1005, 1170] : [420, 525, 630, 735, 840, 990, 1125, 1245] },
            "L35": { destination: "Aéroport", quai:"Lycée", horaires: isWeekend ? [510, 630, 780, 930, 1095] : [405, 510, 645, 765, 900, 1035, 1185, 1320] }
        };
        
        let tableContent = "";
        for (const [ligne, data] of Object.entries(horairesBus)) {
            const nextPassage = data.horaires.find(minutes => minutes > currentMinutesOfDay);
            if (nextPassage) {
                const timeRemaining = nextPassage - currentMinutesOfDay;
                tableContent += `<tr><td>${ligne}</td><td>${data.destination}</td><td>${timeRemaining} min</td><td>${data.quai}</td></tr>`;
            }
        }
        
        horairesDiv.innerHTML = tableContent || "<tr><td colspan='3'>Plus de bus pour aujourd'hui</td></tr>";
    }
        
        updateLedScreen();
        getNextPassages();
        setInterval(updateLedScreen, 1000);
        setInterval(getNextPassages, 60000);
    </script>
</body>
</html>
