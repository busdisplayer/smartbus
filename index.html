<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horaires des Bus</title>
   <style>
    /* Global body styling */
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        text-align: center;
        margin: 0;
        background-color: #121212; /* Dark background */
        color: #1E90FF; /* Blue text color */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        transition: background-color 0.3s ease-in-out;
    }

    /* LED screen styling */
    .led-screen {
        width: 80%;
        margin: 20px 0;
        padding: 30px;
        border-radius: 15px;
        border: 2px solid #1E90FF;
        background-color: #1E1E1E; /* Slightly lighter background for LED screen */
        color: #1E90FF;
        font-size: 1.6em;
        font-weight: bold;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.6); /* Adding shadow for depth */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 150px;
        transition: transform 0.2s ease-in-out;
    }

    .led-screen:hover {
        transform: scale(1.05); /* Slight hover effect to make it interactive */
    }

    /* Table styling */
    table {
        width: 70%;
        margin-top: 30px;
        border-collapse: collapse;
        background-color: #1E1E1E;
        color: #1E90FF;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3); /* Adding shadow for depth */
    }

    th, td {
        padding: 12px;
        text-align: center;
        border-bottom: 1px solid #1E90FF;
        font-size: 1.1em;
    }

    th {
        background-color: #1E90FF;
        color: #ffffff;
        font-weight: 600;
    }

    td {
        background-color: #2A2A2A;
    }

    td:last-child {
        text-align: right; /* Align the time column to the right */
    }

    /* Styling for table rows on hover */
    tr:hover {
        background-color: #333333; /* Darken rows on hover */
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        table {
            width: 90%;
        }

        .led-screen {
            width: 90%;
            font-size: 1.4em;
        }
    }
</style>

</head>
<body>
    <div class="led-screen" id="led-screen">Chargement...</div>
    
    <table>
        <thead>
            <tr>
                <th>Ligne</th>
                <th>Destination</th>
                <th>Temps restant</th>
                <th>Quai</th>
            </tr>
        </thead>
        <tbody id="horaires">
            <tr><td colspan="4">Chargement des horaires...</td></tr>
        </tbody>
    </table>
    <div id="stops"></div>
  <script>
    function updateLedScreen() {
        const now = new Date();
        const dateStr = now.toLocaleDateString('fr-FR');
        const timeStr = now.toLocaleTimeString('fr-FR');
        document.getElementById("led-screen").innerHTML = `Lycée de Beauregard | ${dateStr} - ${timeStr}`;
    }

    // Fonction pour convertir l'heure HH:mm en minutes depuis minuit
    function convertToMinutes(time) {
        const [hours, minutes] = time.split(":").map(Number);
        return hours * 60 + minutes;
    }

    // Fonction pour formater les minutes en HH:mm
    function formatTime(minutes) {
        const hours = Math.floor(minutes / 60);
        const mins = minutes % 60;
        return `${String(hours).padStart(2, '0')}:${String(mins).padStart(2, '0')}`;
    }

    // Fonction pour obtenir les arrêts et la durée de la ligne
    function getLineStops(ligne) {
        const busStops = {
            "L30": [
                { stop: "Lycée", duration: 0 },
                { stop: "Gare Centrale", duration: 15 },
                { stop: "Place des Arts", duration: 30 },
                { stop: "Hôpital", duration: 45 },
                { stop: "Terminal", duration: 60 }
            ],
            "L31": [
                { stop: "Gendarmerie", duration: 0 },
                { stop: "Université", duration: 10 },
                { stop: "Marché", duration: 20 },
                { stop: "Place Centrale", duration: 30 }
            ],
            // Ajoutez les arrêts pour les autres lignes ici...
        };
        return busStops[ligne] || [];
    }

    // Fonction pour obtenir les passages suivants
    function getNextPassages() {
        const horairesDiv = document.getElementById("horaires");
        const now = new Date();
        const currentMinutesOfDay = now.getHours() * 60 + now.getMinutes();
        const isWeekend = now.getDay() === 0 || now.getDay() === 6;

        const horairesBus = {
            "L30": { destination: "Gare Centrale", quai: "Lycée", horaires: isWeekend ? ["09:30", "11:00", "13:30", "15:45", "18:00"] : ["08:00", "09:15", "10:30", "12:00", "14:45", "16:20", "18:00", "19:30", "21:00"] },
            "L31": { destination: "Université", quai: "Gendarmerie", horaires: isWeekend ? ["10:00", "12:30", "14:00", "16:30", "18:00"] : ["07:45", "09:00", "11:15", "12:30", "14:30", "16:05", "18:00"] },
            "L32": { destination: "Hôpital", quai: "Gendarmerie", horaires: isWeekend ? ["08:45", "10:15", "12:45", "14:30", "17:30"] : ["06:30", "07:45", "09:00", "10:30", "12:00", "13:45", "15:10", "16:30"] },
            "L11": { destination: "Stade", quai: "Lycée", horaires: isWeekend ? ["09:15", "11:45", "13:45", "15:45", "17:30"] : ["07:00", "08:30", "10:15", "12:00", "13:30", "15:00", "16:30", "18:00"] },
            "L35": { destination: "Aéroport", quai: "Lycée", horaires: isWeekend ? ["08:30", "10:30", "13:00", "14:30", "17:15"] : ["07:15", "08:15", "09:45", "11:15", "13:00", "14:45", "16:30", "18:45"] }
        };

        let tableContent = "";
        for (const [ligne, data] of Object.entries(horairesBus)) {
            // Convertir les horaires en minutes depuis minuit
            const horairesEnMinutes = data.horaires.map(horaire => convertToMinutes(horaire));
            // Trouver le prochain passage
            const nextPassage = horairesEnMinutes.find(minutes => minutes > currentMinutesOfDay);
            if (nextPassage) {
                const timeRemaining = nextPassage - currentMinutesOfDay;
                const nextTimeFormatted = formatTime(nextPassage); // Convertir les minutes en format HH:mm
                // Récupérer les arrêts et la durée de la ligne
                const stops = getLineStops(ligne);
                tableContent += `<tr><td>${ligne}</td><td>${data.destination}</td><td>${timeRemaining} min</td><td>${data.quai}</td><td>${nextTimeFormatted}</td><td><button onclick="showLineStops('${ligne}')">Voir les arrêts</button></td></tr>`;
            }
        }

        horairesDiv.innerHTML = tableContent || "<tr><td colspan='6'>Plus de bus pour aujourd'hui</td></tr>";
    }

    // Fonction pour afficher les arrêts d'une ligne
    function showLineStops(ligne) {
        const stops = getLineStops(ligne);
        let stopsContent = `<h3>Arrêts de la ligne ${ligne}</h3><ul>`;
        stops.forEach(stop => {
            const stopTime = formatTime(stop.duration);
            stopsContent += `<li>${stop.stop} - ${stopTime}</li>`;
        });
        stopsContent += "</ul>";

        const stopsDiv = document.getElementById("stops");
        stopsDiv.innerHTML = stopsContent;
    }

    updateLedScreen();
    getNextPassages();
    setInterval(updateLedScreen, 1000);
    setInterval(getNextPassages, 60000);
</script>


</body>
</html>
