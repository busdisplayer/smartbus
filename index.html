<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horaires des Transports</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <style>
        .details-container { display: none; }
        .bus-list { cursor: pointer; }
    </style>
</head>
<body>
    <div class="w3-container">
        <h2 class="w3-center">Prochains Départs</h2>
        <table class="w3-table w3-striped w3-bordered">
            <thead>
                <tr class="w3-blue">
                    <th>Ligne</th>
                    <th>Destination</th>
                    <th>Départ dans</th>
                </tr>
            </thead>
            <tbody id="schedule"></tbody>
        </table>
    </div>

    <div id="details" class="w3-container w3-pale-blue w3-padding details-container">
        <h3 id="details-title"></h3>
        <p><strong>Heure d'arrivée :</strong> <span id="arrival-time"></span></p>
        <h4>Liste des arrêts :</h4>
        <ul id="stops-list" class="w3-ul w3-card-4"></ul>
    </div>

    <script>
        const schedules = [
            { line: "L11", destination: "Saint-Étienne", departure: "14:48", arrival: "15:30", stops: ["Arrêt A", "Arrêt B", "Arrêt C"] },
            { line: "T1", destination: "Lyon", departure: "15:00", arrival: "16:10", stops: ["Arrêt D", "Arrêt E", "Arrêt F"] },
            { line: "L3", destination: "Grenoble", departure: "14:55", arrival: "16:00", stops: ["Arrêt G", "Arrêt H", "Arrêt I"] }
        ];

        function calculateTimeDifference(departureTime) {
            const now = new Date();
            const [hours, minutes] = departureTime.split(':').map(Number);
            const departure = new Date();
            departure.setHours(hours, minutes, 0);
            return Math.round((departure - now) / 60000);
        }

        function updateSchedule() {
            const tableBody = document.getElementById("schedule");
            tableBody.innerHTML = "";
            
            schedules.sort((a, b) => calculateTimeDifference(a.departure) - calculateTimeDifference(b.departure));
            
            schedules.forEach(schedule => {
                const row = document.createElement("tr");
                row.classList.add("bus-list");
                row.innerHTML = `
                    <td>${schedule.line}</td>
                    <td>${schedule.destination}</td>
                    <td>${calculateTimeDifference(schedule.departure)} min (${schedule.departure})</td>
                `;
                row.onclick = () => showDetails(schedule);
                tableBody.appendChild(row);
            });
        }

        function showDetails(schedule) {
            document.getElementById("details").style.display = "block";
            document.getElementById("details-title").textContent = `Détails de la ligne ${schedule.line}`;
            document.getElementById("arrival-time").textContent = schedule.arrival;
            
            const stopsList = document.getElementById("stops-list");
            stopsList.innerHTML = "";
            schedule.stops.forEach(stop => {
                const li = document.createElement("li");
                li.textContent = stop;
                stopsList.appendChild(li);
            });
        }

        updateSchedule();
        setInterval(updateSchedule, 60000);
    </script>
</body>
</html>
